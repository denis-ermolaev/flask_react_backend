## Бэкенд (Python, Flask)

Бэкенд-приложение на Flask предоставляет RESTful API для управления пользователями.

### Особенности реализации и улучшения

- **Надежная архитектура:** Логика работы с базой данных полностью отделена от логики обработки HTTP-запросов (роутов).
- **Принцип DRY (Don't Repeat Yourself):** Для исключения дублирования кода при работе с БД используется кастомный декоратор `@db_func`, который управляет подключениями и транзакциями.
- **Пагинация на стороне сервера:** Реализован эндпоинт `/users` с серверной пагинацией, что критически важно для производительности при работе с большими объемами данных.
- **Продвинутая валидация:** Эндпоинт создания пользователя (`POST /user`) включает полную серверную валидацию: проверка на наличие полей, их типы, длину строк, корректность формата email и его уникальность в базе данных.
- **Покрытие тестами:** API покрыто автоматическими тестами с использованием `pytest`, которые проверяют как успешные сценарии, так и обработку различных ошибок (несуществующий пользователь, дубликат email и т.д.).
- **Глобальный обработчик ошибок:** Настроен кастомный обработчик для ошибки 404, который гарантирует, что API всегда будет возвращать ошибки в формате JSON, а не стандартные HTML-страницы.

### Установка и запуск

1.  **Перейдите в папку с бэкендом:**

    ```
    cd flask_test_task
    ```

2.  **Создайте и активируйте виртуальное окружение:**

    ```
    # Создаем окружение в папке .venv
    python -m venv .venv

    # Активация в Windows
    .venv\Scripts\activate

    # Активация в macOS/Linux
    source .venv/bin/activate
    ```

3.  **Установите зависимости:**

    ```
    pip install -r requirements.txt
    ```

4.  **Инициализируйте базу данных:**
    Эта команда удалит старую `database.db` (если она есть) и создаст новую с тестовыми пользователем.

    ```
    python database_handler.py
    ```

5.  **Запустите Flask-сервер:**

    ```
    # Обычный запуск
    flask run

    # Запуск в режиме отладки (с автоматической перезагрузкой)
    flask run --debug
    ```

    Сервер будет доступен по адресу `http://127.0.0.1:5000`.

### Запуск тестов

Для запуска автоматических тестов выполните команду в папке `flask_test_task/`, предварительно активировав виртуальное окружение:

```
pytest
```

---

## Документация по API

### Получить список пользователей

- **Метод:** `GET`
- **URL:** `/users`
- **Query-параметры:**
  - `page` (int, опционально, по умолчанию: 1) - Номер страницы.
  - `per_page` (int, опционально, по умолчанию: 10, макс: 100) - Элементов на странице.
- **Успешный ответ (200 OK):**
  ```
  {
    "meta": {
      "page": 1,
      "per_page": 10,
      "total_pages": 3,
      "total_items": 21
    },
    "data": [
      {
        "id": 1,
        "name": "Елена Смирнова",
        "email": "elena.smirnova@example.com"
      }
    ]
  }
  ```

### Получить одного пользователя по ID

- **Метод:** `GET`
- **URL:** `/user/<id>`
- **Path-параметры:**
  - `id` (int, обязательно) - Уникальный идентификатор пользователя.
- **Успешный ответ (200 OK):**
  ```
  {
    "id": 1,
    "name": "Елена Смирнова",
    "email": "elena.smirnova@example.com"
  }
  ```
- **Ошибка (404 Not Found):**
  ```
  {
    "error": "User not found"
  }
  ```

### Создать нового пользователя

- **Метод:** `POST`
- **URL:** `/user`
- **Тело запроса (JSON):**
  ```
  {
    "name": "Новый Пользователь",
    "email": "new.user@example.com"
  }
  ```
- **Успешный ответ (201 Created):**
  ```
  {
    "id": 22,
    "name": "Новый Пользователь",
    "email": "new.user@example.com"
  }
  ```
- **Ошибки:**
  - `400 Bad Request` - Если не хватает полей, неверный формат или длина.
  - `409 Conflict` - Если такой email уже существует.
